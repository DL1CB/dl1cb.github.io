(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"8b24":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md"},[1==t.step?a("q-card",{staticClass:"my-card"},[a("q-card-section",[a("q-input",{attrs:{outlined:"",label:"Full Name",value:t.name},on:{input:t.setName}}),a("q-input",{attrs:{outlined:"",label:"Telephone Number",value:t.phone},on:{input:t.setPhone}}),a("q-input",{attrs:{outlined:"",label:"Email",value:t.email},on:{input:t.setEmail}})],1),a("q-card-actions",{attrs:{vertical:""}},[a("q-btn",{staticClass:"glossy",attrs:{rounded:"",color:"primary",label:"Register"},on:{click:t.connectDigiReg}})],1)],1):t._e(),2==t.step?a("q-card",{staticClass:"my-card"},[a("q-card-section",[a("q-img",{attrs:{src:"/encrypt.svg",basic:""}})],1)],1):t._e(),3==t.step?a("q-card",{staticClass:"my-card"},[a("q-card-section",[a("q-img",{attrs:{src:"/transfer.svg",basic:""}})],1)],1):t._e(),4==t.step?a("q-card",{staticClass:"my-card"},[a("q-card-section",[a("q-img",{attrs:{src:"/success.svg",basic:""}})],1)],1):t._e(),t.establishments.length?a("q-card",{staticClass:"my-card",attrs:{flat:"",bordered:""}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("Registrations ( Last 14 Days)")]),a("q-timeline",{attrs:{color:"secondary"}},t._l(t.establishments,(function(e){return a("q-timeline-entry",{key:e.timestamp,attrs:{title:e.name,subtitle:t.formatDate(new Date(e.timestamp),"D MMM YYYY - h:mm a")}},[t._v("\n          "+t._s(e.street)+" "+t._s(e.city)+" "+t._s(e.zip)),a("br"),t._v("\n          "+t._s(e.state)+" "+t._s(e.country)),a("br"),t._v("\n          "+t._s(e.phone)+" "),a("br"),t._v("\n          "+t._s(e.email)+" "),a("br"),t._v("\n          "+t._s(e.id)+" "),a("br")])})),1)],1)],1):t._e()],1)},i=[],n=(a("e6cf"),a("ded3")),c=a.n(n),r=a("b178"),o=a("2f62");const l=Object(o["a"])("patron"),d=Object(o["a"])("establishments");var m={name:"DigiReg",data(){return{step:1}},mounted:function(){this.fetchEstablishments(),this.fetchLastPatron()},computed:c()(c()(c()({},l.mapState(["date","name","phone","email"])),l.mapGetters(["encodedPatron"])),d.mapState(["establishments"])),methods:c()(c()(c()({},l.mapActions(["fetchLastPatron","setName","setPhone","setEmail","saveLatestPatron"])),d.mapActions(["fetchEstablishments","addEstablishment"])),{},{formatDate:r["a"].formatDate,async connectDigiReg(){const t="6e400001-b5a3-f393-e0a9-e50e24dcca9e",e="6e400002-b5a3-f393-e0a9-e50e24dcca9e",a="6e400003-b5a3-f393-e0a9-e50e24dcca9e",s=await navigator.bluetooth.requestDevice({filters:[{services:[t]}]}),i=await s.gatt.connect();s.addEventListener("gattserverdisconnected",this.onDisconnected),this.step=2;const n=await i.getPrimaryService(t),c=await n.getCharacteristic(a);c.addEventListener("characteristicvaluechanged",this.onDigiRegDataReceived),c.startNotifications();const r=await n.getCharacteristic(e);this.step=3,await r.writeValue(this.encodedPatron)},onDigiRegDataReceived(t){this.addEstablishment(t.target.value),this.saveLatestPatron(),this.step=4,t.currentTarget.service.device.gatt.disconnect()},onDisconnected(t){this.step=1}})},h=m,u=a("2877"),p=Object(u["a"])(h,s,i,!1,null,null,null);e["default"]=p.exports}}]);